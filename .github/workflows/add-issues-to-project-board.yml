name: Reusable workflow for adding issues to the web project board

on:
  issues:
    types:
      - opened
      - labeled
  workflow_call:
    inputs:
      github-token:
        description: 'A token generated with tibdex/github-app-token community action'
        default: ' '
        required: false
        type: string
    secrets:
      APP_ID:
        required: true
      PRIVATE_KEY: 
        required: true
      PROJECT_URL:
        required: true
      GITHUB_TOKEN:
        required: true
    
jobs:
  add_issues_to_project_board:
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - name: Generate token
        id: generate_token
        uses: tibdex/github-app-token@v1.7.0
        with:
          app_id: ${{ secrets.APP_ID }}
          private_key: ${{ secrets.PRIVATE_KEY }}
      - name: Add issues to project board
        uses: actions/add-to-project@v0.3.0
        env: 
          GITHUB_TOKEN: ${{ steps.generate_token.outputs.token }}
        with:
          project-url: ${{ secrets.PROJECT_URL }}
          github-token: ${{ secrets.GITHUB_TOKEN }}